package de.fitcontrol.domain.model;

import java.time.Duration;
import java.time.LocalDateTime;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

import org.springframework.data.annotation.Id;
import org.springframework.data.mongodb.core.mapping.Document;

import com.fasterxml.jackson.annotation.JsonCreator;
import com.fasterxml.jackson.annotation.JsonProperty;

import de.fitcontrol.domain.model.enums.MuscleGroup;
import lombok.AllArgsConstructor;
import lombok.Getter;
import lombok.NoArgsConstructor;
import lombok.Setter;
import lombok.experimental.SuperBuilder;

@Document(collection = "workout")
@SuperBuilder
@NoArgsConstructor
@AllArgsConstructor
public class Workout {
	

    @Id
    @Getter
    private  String id;
	
    /*
    public Workout() {
		super();
	}

	@JsonCreator
	public Workout(
			@JsonProperty("exercises") Map<String, Exercise> exercises, 
			@JsonProperty("title") String title, 
			@JsonProperty("date") LocalDateTime date, 
			@JsonProperty("duration") Duration duration
			) {
		this.exercises = exercises;
		this.title = title;
		this.date = date;
		this.duration = duration;
	}
	*/

	@Setter
	private Map<String, Exercise> exercises;
	
	@Getter
	@Setter
	private String title;
	
	@Getter
	@Setter
	private LocalDateTime date;
	
	@Getter
	@Setter
	private Duration duration;
	
	
	public void addExercise(Exercise exercise) {
		if (this.exercises == null) {
			this.exercises = new HashMap<String, Exercise>();
		}
		this.exercises.put(exercise.getId(), exercise);
	}
	
	public void updateExercise(Exercise updatedExercise) {
        if (this.exercises.containsKey(updatedExercise.getId())) {
        	this.exercises.put(updatedExercise.getId(), updatedExercise);
        } else {
            throw new IllegalArgumentException("..."); //TODO
        }
	}
	
	public void deleteExercise(Exercise updatedExercise) {
        if (this.exercises.containsKey(updatedExercise.getId())) {
        	this.exercises.remove(updatedExercise.getId(), updatedExercise);
        } else {
            throw new IllegalArgumentException("..."); //TODO
        }
	}
	
	public void addExerciseSet(Exercise exercise, ExerciseSet exerciseSet) {
		exercise.getSets().put(exerciseSet.getId(), exerciseSet);
		this.exercises.put(exercise.getId(), exercise);
	}
	
	public void updateExerciseSet(Exercise exercise, ExerciseSet exerciseSet) {
		if (this.exercises.containsKey(exercise.getId())) {
			exercise.getSets().put(exerciseSet.getId(), exerciseSet);
		} else {
			throw new IllegalArgumentException("..."); //TODO
		}
	}
	
	public void deleteExerciseSet(Exercise exercise, String exerciseSeId) {
		if (this.exercises.containsKey(exercise.getId())) {
			exercise.getSets().remove(exerciseSeId);
			// TODO : not necessary: this.exercises.put(exercise.getId(), exercise); ??
		} else {
			throw new IllegalArgumentException("..."); //TODO
		}
	}
	
	public void addReps(ExerciseSet exerciseSet, Map<String, Rep> reps) {
		exerciseSet.getReps().putAll(reps);
	}

	public Map<String, Exercise> getExercises() {
		if (this.exercises == null) {
			this.exercises = new HashMap<>();
		}
		return exercises;
	}


	
	
	
	
}
